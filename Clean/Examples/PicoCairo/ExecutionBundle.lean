/-
PicoCairo Execution Bundle
Generated by Claude
-/

import Clean.Circuit.Basic
import Clean.Utils.Vector
import Clean.Examples.PicoCairo.Types
import Clean.Examples.PicoCairo.AddInstruction
import Clean.Examples.PicoCairo.MulInstruction
import Clean.Examples.PicoCairo.StoreStateInstruction
import Clean.Examples.PicoCairo.LoadStateInstruction

namespace Examples.PicoCairo

variable {p : ℕ} [Fact p.Prime] [p_large_enough: Fact (p > 512)]

/--
Main execution bundle that combines all instruction type bundles.
For now, only includes ADD instructions.
-/
def executionBundleMain
    (addCapacity : ℕ) [NeZero addCapacity]
    {programSize : ℕ} [NeZero programSize] (program : Fin programSize → (F p)) (h_programSize : programSize < p)
    {memorySize : ℕ} [NeZero memorySize] (memory : Fin memorySize → (F p)) (h_memorySize : memorySize < p)
    (addInputs : Var (ProvableVector InstructionStepInput addCapacity) (F p)) :
    Circuit (F p) Unit := do

  -- Execute ADD instruction bundle
  addStepCircuitsBundle addCapacity program h_programSize memory h_memorySize addInputs

  -- Future: Add other instruction bundles (will need NeZero constraints and ProvableVector inputs)
  -- mulStepCircuitsBundle mulCapacity program h_programSize memory h_memorySize mulInputs
  -- loadStateStepCircuitsBundle loadCapacity program h_programSize memory h_memorySize loadInputs
  -- storeStateStepCircuitsBundle storeCapacity program h_programSize memory h_memorySize storeInputs

  return ()

end Examples.PicoCairo